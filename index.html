<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <!-- 不让百度转码 -->
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <!-- uc强制竖屏 -->
  <meta name="screen-orientation" content="portrait">
  <!-- QQ强制竖屏 -->
  <meta name="x5-orientation" content="portrait">
  <!-- UC强制全屏 -->
  <meta name="full-screen" content="yes">
  <!-- QQ强制全屏 -->
  <meta name="x5-fullscreen" content="true">
  <!-- UC应用模式 -->
  <meta name="browsermode" content="application">
  <!-- QQ应用模式 -->
  <meta name="x5-page-mode" content="app">
  <!-- iOS 设备 begin -->
  <!-- 添加到主屏后的标题（iOS 6 新增） -->
  <meta name="apple-mobile-web-app-title" content="有市">
  <!-- 是否启用 WebApp 全屏模式，删除苹果默认的工具栏和菜单栏 -->
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <!-- 将网站添加到主屏幕快速启动方式，仅针对ios的safari顶端状态条的样式 -->
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <!-- 这个标签是告诉iphone的safari浏览器，这个网站对应的app是什么，然后在页面上面显示一个下载banner -->
  <!-- <meta name="apple-itunes-app" content="app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> -->
  <meta name="format-detection" content="telephone=no">
  <meta name="description" content="聊天室">
  <meta name="Keywords" content="聊天室">
  <!-- Retina iPhone 和 Retina iTouch，114x114 像素，可以没有，但推荐有 -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/logo.png"/>
  <!-- iOS 启动画面 begin -->
  <!-- <link rel="apple-touch-startup-image" sizes="640x1136" href="/images/splash-640x1136.png"/> -->
  <link rel="apple-touch-startup-image" sizes="640x1136" href="/images/splash-750x1334.png"/>
  <!-- <link rel="apple-touch-startup-image" sizes="1242x2208" href="/images/splash-1242x2208.png"/> -->
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
  <title>Chat</title>
  <style>
    html {background-color: #ebeafd; font-size: 14px;}
    body {margin: 0;}
    header { background-color: #fff; line-height: 48px; text-align: center; box-shadow: 0 0 10px 0 rgba(0, 0, 0, .2) }
    .message {background-color: #44337b; color: #fff;}
  </style>
</head>
<body>
  <header id="mess">正在连接...</header>
  <div class="kuang">sdfsdf</div>
  <div id="message"></div>
  <script>
    var mess = document.getElementById('mess');
    if(window.WebSocket){
        var ws = new WebSocket('ws://192.168.112.15:8001');

        ws.onopen = function(e){
          console.log('连接服务器成功');
          ws.send('game1');
        }
        ws.onclose = function(e){
          console.log('服务器关闭');
        }
        ws.onerror = function(){
          console.log('连接出错');
        }

        ws.onmessage = function(e){
          mess.innerHTML = '聊天室'
          document.querySelector('.kuang').onclick = function(e){
              var time = new Date();
              ws.send(time + '  game1点击了“' + e.target.innerHTML+'”');
          }
          var time = new Date();
          const message = document.createElement('div')
          message.className = 'message'
          message.innerText = e.data
          document.getElementById('message').appendChild(message)
          // mess.innerHTML+=time+'的消息：'+e.data+'<br>'
        }
    }
  </script>
</body>
</html>
